<div class="form-container">
    <mat-card class="form-card">
        <mat-card-header>
            <mat-icon mat-card-avatar color="primary">{{ isEditMode ? 'person' : 'person_add' }}</mat-icon>
            <mat-card-title>{{ isEditMode ? 'Editar Usuario' : 'Registrar Nuevo Usuario' }}</mat-card-title>
            <mat-card-subtitle>{{ isEditMode ? 'Actualice la información del usuario' : 'Cree una cuenta y asígnela a
                este restaurante' }}</mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
            <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">
                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Nombre Completo</mat-label>
                    <input matInput formControlName="nombre" placeholder="Ej: Juan Pérez">
                    <mat-error *ngIf="userForm.get('nombre')?.hasError('required')">Nombre es requerido</mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Correo Electrónico</mat-label>
                    <input matInput formControlName="email" type="email" placeholder="ejemplo@correo.com">
                    <mat-error *ngIf="userForm.get('email')?.hasError('required')">Email es requerido</mat-error>
                    <mat-error *ngIf="userForm.get('email')?.hasError('email')">Email inválido</mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>{{ isEditMode ? 'Cambiar Contraseña (Opcional)' : 'Contraseña Temporal' }}</mat-label>
                    <input matInput formControlName="password" type="password">
                    <mat-hint>{{ isEditMode ? 'Dejar en blanco para mantener la actual. Mínimo 6 caracteres.' : 'Mínimo
                        6 caracteres' }}</mat-hint>
                    <mat-error *ngIf="userForm.get('password')?.hasError('required')">Contraseña es
                        requerida</mat-error>
                    <mat-error *ngIf="userForm.get('password')?.hasError('minlength')">Mínimo 6 caracteres</mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Rol en el Restaurante</mat-label>
                    <mat-select formControlName="rol">
                        <mat-option *ngFor="let role of availableRoles" [value]="role.value">
                            {{role.label}}
                        </mat-option>
                    </mat-select>
                    <mat-error *ngIf="userForm.get('rol')?.hasError('required')">El rol es requerido</mat-error>
                </mat-form-field>

                <div class="actions">
                    <button mat-button type="button" routerLink="/usuarios" [disabled]="isLoading">Cancelar</button>
                    <button mat-raised-button color="primary" type="submit" [disabled]="userForm.invalid || isLoading">
                        {{ isLoading ? 'Guardando...' : (isEditMode ? 'Guardar Cambios' : 'Crear Usuario' ) }}
                    </button>
                </div>
            </form>
        </mat-card-content>
    </mat-card>
</div>